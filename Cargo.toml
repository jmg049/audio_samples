[package]
name = "audio_samples"
version = "0.10.0"
edition = "2024"
authors = ["Jack Geraghty <jgeraghty049@gmail.com>"]
license = "MIT"
readme = "README.md"
homepage = "https://github.com/jmg049/audio_samples"
repository = "https://github.com/jmg049/audio_samples"
documentation = "https://docs.rs/audio_samples"
description = "A high-performance audio processing library for Rust"

keywords = ["audio", "dsp", "api"]
categories = ["encoding", "multimedia", "science"]

[lib]
name = "audio_samples"
crate-type = ["rlib"]

[dependencies]
bytemuck = "1.23.1"
colored = "3.0.0"
ndarray = "0.17.1"
num-traits = "0.2.19"
thiserror = "2.0.12"
tracing = "0.1.41"
approx_eq = "0.1.8"
num-complex = "0.4"
i24 = {version = "2.2.5", features = ["alloc","num-cast", "ndarray" ,"std", "serde"]}
serde = "1.0.219"
lazy_static = "1.4"
num-format = "0.4.4"
rand = "0.9.2"
anyhow = "1.0.100"

# FFT dependencies (gated behind "fft" feature)
rustfft = { version = "6.2", optional = true }
realfft = { version = "3.4", optional = true }
fftw-sys = { version = "0.4.0", features = ["intel-mkl"], optional = true }
intel-mkl-src = { version = "0.8.0", optional = true }

# Plotting dependencies (gated behind "plotting" feature)
plotly = { version = "0.13.5", optional = true }
# plotview-rs = { path = "/home/jmg/code/rust/plotview-rs/", optional = true }
plotly_static = { version = "0.1.0", features = ["chromedriver", "webdriver_download"], optional = true }
serde_json = { version = "1.0", optional = true }

# Resampling dependencies (gated behind "resampling" feature)
rubato = { version = "0.16.2", optional = true }

# Performance dependencies (optional features)
rayon = { version = "1.10", optional = true }
num_cpus = { version = "1.16", optional = true }
wide = { version = "0.7", optional = true }
indicatif = { version = "0.18", optional = true }
paste = "1.0.15"

[features]
# Minimal core (no heavy dependencies)
default = ["full"]

# Core audio operations (no FFT/plotting/resampling)
core-ops = []

# All 
full = [
    "core-ops",
    "fft",
    "plotting",
    "resampling",
    "static-plots",
    "parallel-processing",
    "simd",
    "mkl",
    "progress-tracking",
    "beat-detection"
]

# Major functionality groups
fft = ["core-ops", "dep:rustfft", "dep:realfft"]
plotting = ["core-ops", "dep:plotly"]
resampling = ["core-ops", "dep:rubato"]

# FFT-dependent features (require fft)
spectral-analysis = ["fft"]
beat-detection = ["fft", "spectral-analysis"]

# Plotting sub-features (require plotting)
static-plots = ["plotting", "dep:plotly_static", "dep:serde_json"]

# Performance features (independent)
parallel-processing = ["dep:rayon", "dep:num_cpus"]
simd = ["dep:wide"]
mkl = ["fft", "dep:fftw-sys", "dep:intel-mkl-src"]
progress-tracking = ["dep:indicatif"]

# Convenience feature groups
full-analysis = ["spectral-analysis", "beat-detection", "plotting"]
operations = ["core-ops", "spectral-analysis", "plotting", "resampling"]

